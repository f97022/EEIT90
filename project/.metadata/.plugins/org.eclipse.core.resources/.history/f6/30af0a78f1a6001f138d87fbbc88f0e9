package com.cloudSerenityHotel.dao.user;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.SQLException;
import java.sql.Timestamp;
import java.time.LocalDateTime;

import com.cloudSerenityHotel.bean.user.UserBean;
import com.cloudSerenityHotel.utils.JDBCUtils;

public class UserDAO {
	private static final String INSERT = "INSERT INTO users(email,password,user_status,user_identity,update_time) VALUES(?,?,?,?,?)";
	private static final String DELETE = "UPDATE users SET user_status = ? WHERE userid =?";
	private static final String UPDATE_EMAIL = "UPDATE users SET email=? WHERE userid =?";
	private static final String UPDATE_PASSWORD = "UPDATE users SET password=? WHERE userid =?";
	private static final String GETONE = "SELECT * FROM users WHERE userid =?";
	private static final String GETALL = "SELECT * FROM users";

	public int addUser(UserBean bean) {
		int insertCount = 0;
		Connection conn =JDBCUtils.getConnection();
		PreparedStatement stmt =null;
		try {
			stmt = conn.prepareStatement(INSERT);
			stmt.setString(1,bean.getEmail());
			stmt.setString(2,bean.getPassword());
			stmt.setString(3,bean.getUserStatus());
			stmt.setString(4,bean.getUserIdentity());
			//取現在的時間
			LocalDateTime now = LocalDateTime.now();
			Timestamp timestamp = Timestamp.valueOf(now);
			stmt.setTimestamp(5,timestamp);
			insertCount = stmt.executeUpdate();
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}finally {
			JDBCUtils.closeResource(conn, stmt, null);
		}
		return insertCount;
	};
}
